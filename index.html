<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KSO Content Studio</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root { --accent: #ff4757; --bg: #f1f2f6; --tiktok: #000000; --youtube: #FF0000; --facebook: #1877F2; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background: var(--bg); display: flex; justify-content: center; align-items: center; min-height: 100vh; padding: 20px; }

        .container { background: white; width: 100%; max-width: 600px; border-radius: 35px; padding: 30px; box-shadow: 0 25px 70px rgba(0,0,0,0.15); text-align: center; border: 2px solid #fff; }
        
        .brand-header { margin-bottom: 25px; }
        .brand-name { font-size: 28px; font-weight: 900; color: #2f3542; letter-spacing: 2px; text-transform: uppercase; }
        .brand-name span { color: var(--accent); }

        .tabs { display: flex; background: #dfe4ea; border-radius: 20px; padding: 6px; margin-bottom: 25px; }
        .tab { flex: 1; padding: 12px; cursor: pointer; border-radius: 15px; font-weight: bold; transition: 0.3s; display: flex; align-items: center; justify-content: center; gap: 10px; color: #57606f; }
        .tab.active { background: white; color: var(--accent); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }

        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(170px, 1fr)); gap: 15px; text-align: left; margin-bottom: 25px; }
        .label { display: flex; align-items: center; gap: 8px; font-size: 11px; font-weight: bold; margin-bottom: 8px; color: #747d8c; text-transform: uppercase; }
        .select-box { width: 100%; padding: 12px; border: 1px solid #ced4da; border-radius: 14px; outline: none; background: #fff; cursor: pointer; font-size: 14px; color: #2f3542; }

        /* Canvas & Frame */
        #capture-area { 
            width: 100%; height: 500px; background: #f8f9fa; 
            margin-bottom: 20px; border-radius: 25px;
            display: flex; flex-direction: column; justify-content: center; align-items: center; 
            position: relative; overflow: hidden; transition: 0.4s;
            border: 2px dashed #dcdde1;
        }

        .phone-frame { 
            width: 220px; height: 460px; background: #000; 
            border: 10px solid #2f3542; border-radius: 45px; 
            position: relative; overflow: hidden; display: flex; align-items: center; justify-content: center;
            transition: 0.3s; z-index: 5; box-shadow: 0 20px 50px rgba(0,0,0,0.3);
        }

        .notch { position: absolute; background: #000; z-index: 10; transition: 0.3s; }
        .dynamic-island { width: 65px; height: 22px; border-radius: 20px; top: 12px; }
        .waterdrop { width: 30px; height: 18px; border-bottom-left-radius: 15px; border-bottom-right-radius: 15px; top: 0; }
        .punch-hole { width: 10px; height: 10px; border-radius: 50%; top: 16px; }

        .kso-watermark { position: absolute; bottom: 15px; color: rgba(255,255,255,0.4); font-size: 10px; font-weight: bold; letter-spacing: 2px; z-index: 11; pointer-events: none; }

        #preview-img, #preview-video { width: 100%; height: 100%; object-fit: cover; display: none; }
        #plus-icon { font-size: 50px; color: #2f3542; position: absolute; z-index: 1; opacity: 0.2; }

        .btn { width: 100%; padding: 18px; border-radius: 50px; border: none; font-weight: bold; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 12px; margin-top: 12px; font-size: 16px; transition: 0.3s; }
        .btn-upload { background: #f1f2f6; color: #2f3542; border: 1px solid #ced4da; }
        .btn-upload:hover { background: #dfe4ea; }
        .btn-save { background: var(--accent); color: white; display: none; box-shadow: 0 10px 25px rgba(255, 71, 87, 0.3); }
        .btn-save:hover { transform: translateY(-3px); box-shadow: 0 15px 30px rgba(255, 71, 87, 0.4); }

        #status { font-size: 14px; color: var(--accent); margin-top: 15px; font-weight: bold; display: none; }
    </style>
</head>
<body>

<div class="container">
    <div class="brand-header">
        <h1 class="brand-name"><span>KSO</span> Studio</h1>
    </div>

    <div class="tabs">
        <div class="tab active" onclick="switchTab('image', event)"><i class="fas fa-image"></i> Photo</div>
        <div class="tab" onclick="switchTab('video', event)"><i class="fas fa-play-circle"></i> Video</div>
    </div>

    <div class="grid">
        <div>
            <label class="label"><i class="fas fa-mobile-alt"></i> Model</label>
            <select class="select-box" onchange="updateModel(this.value)">
                <option value="iphone">iPhone 14 Pro</option>
                <option value="vivo">vivo Y72 5G</option>
                <option value="samsung">SAMSUNG S25</option>
            </select>
        </div>
        <div>
            <label class="label"><i class="fas fa-palette"></i> Color</label>
            <select class="select-box" onchange="updateColor(this.value)">
                <option value="#2f3542">Space Black</option>
                <option value="#dcdde1">Silver Ice</option>
                <option value="#eccc68">Lux Gold</option>
                <option value="#1e90ff">Deep Blue</option>
            </select>
        </div>
        <div id="video-size-ctrl" style="display:none;">
            <label class="label"><i class="fas fa-hashtag"></i> Platform Size</label>
            <select class="select-box" onchange="updateVideoSize(this.value)">
                <option value="9/16">TikTok (9:16)</option>
                <option value="16/9">YouTube (16:9)</option>
                <option value="1/1">Facebook (1:1)</option>
            </select>
        </div>
    </div>

    <div id="capture-area">
        <div class="phone-frame" id="phone-ui">
            <div id="notch-ui" class="notch dynamic-island"></div>
            <div class="kso-watermark">KSO STUDIO</div>
            <i class="fas fa-file-export" id="plus-icon"></i>
            <img id="preview-img">
            <video id="preview-video" muted playsinline loop></video>
        </div>
    </div>

    <div id="status"><i class="fas fa-sync fa-spin"></i> KSO Studio is processing...</div>

    <input type="file" id="file-in" style="display:none;">
    <button class="btn btn-upload" onclick="document.getElementById('file-in').click()">
        <i class="fas fa-plus-circle"></i> တင်မည့်ဖိုင်ရွေးပါ
    </button>

    <button class="btn btn-save" id="save-btn">
        <i class="fas fa-arrow-alt-circle-down"></i> ဒေါင်းလုဒ်ရယူမည်
    </button>
</div>

<script>
    let currentMode = 'image';
    const canvas = document.getElementById('capture-area');
    const phone = document.getElementById('phone-ui');
    const notch = document.getElementById('notch-ui');
    const img = document.getElementById('preview-img');
    const video = document.getElementById('preview-video');
    const plusIcon = document.getElementById('plus-icon');
    const saveBtn = document.getElementById('save-btn');
    const fileIn = document.getElementById('file-in');
    const videoCtrl = document.getElementById('video-size-ctrl');

    function switchTab(mode, event) {
        currentMode = mode;
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        event.currentTarget.classList.add('active');
        fileIn.accept = mode === 'image' ? "image/*" : "video/*";
        videoCtrl.style.display = mode === 'video' ? 'block' : 'none';
        
        if(mode === 'video') {
            updateVideoSize('9/16');
        } else {
            canvas.style.aspectRatio = "unset";
            canvas.style.width = "100%";
            canvas.style.height = "500px";
            phone.style.transform = "scale(1)";
            canvas.style.backgroundColor = "#f8f9fa";
        }
    }

    function updateModel(model) {
        notch.className = "notch";
        if (model === 'iphone') {
            notch.classList.add('dynamic-island');
            phone.style.borderRadius = "45px";
        } else if (model === 'vivo') {
            notch.classList.add('waterdrop');
            phone.style.borderRadius = "30px";
        } else if (model === 'samsung') {
            notch.classList.add('punch-hole');
            phone.style.borderRadius = "38px";
        }
    }

    function updateColor(color) {
        phone.style.borderColor = color;
    }

    function updateVideoSize(ratio) {
        canvas.style.aspectRatio = ratio;
        if (ratio === '16/9') {
            phone.style.transform = "scale(0.55)"; 
            canvas.style.width = "100%";
            canvas.style.height = "320px";
            canvas.style.backgroundColor = "#ff767520"; 
        } else if (ratio === '1/1') {
            phone.style.transform = "scale(0.75)"; 
            canvas.style.width = "400px";
            canvas.style.height = "400px";
            canvas.style.backgroundColor = "#74b9ff20";
        } else {
            phone.style.transform = "scale(1)"; 
            canvas.style.width = "300px";
            canvas.style.height = "500px";
            canvas.style.backgroundColor = "#2d343610";
        }
    }

    fileIn.onchange = (e) => {
        const file = e.target.files[0];
        if (!file) return;
        const url = URL.createObjectURL(file);
        plusIcon.style.display = 'none';
        saveBtn.style.display = 'flex';

        if (currentMode === 'image') {
            img.src = url; img.style.display = 'block'; video.style.display = 'none';
        } else {
            video.src = url; video.style.display = 'block'; img.style.display = 'none';
            video.play();
        }
    };

    saveBtn.onclick = async () => {
        document.getElementById('status').style.display = 'block';
        if (currentMode === 'image') {
            const result = await html2canvas(canvas, { scale: 3, backgroundColor: null });
            const link = document.createElement('a');
            link.download = `KSO_Mockup_${Date.now()}.png`;
            link.href = result.toDataURL();
            link.click();
            document.getElementById('status').style.display = 'none';
        } else {
            const stream = video.captureStream();
            const recorder = new MediaRecorder(stream, { mimeType: 'video/webm' });
            const chunks = [];
            recorder.ondataavailable = (e) => chunks.push(e.data);
            recorder.onstop = () => {
                const blob = new Blob(chunks, { type: 'video/webm' });
                const a = document.createElement('a');
                a.href = URL.createObjectURL(blob);
                a.download = `KSO_Video_${Date.now()}.webm`;
                a.click();
                document.getElementById('status').style.display = 'none';
            };
            video.currentTime = 0; video.play(); recorder.start();
            setTimeout(() => recorder.stop(), video.duration * 1000);
        }
    };
</script>

</body>
</html>
