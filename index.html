<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DMO Mockup Studio - Ultimate Edition</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root { --accent: #007bff; --bg: #f8f9fa; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: sans-serif; }
        body { background: var(--bg); display: flex; justify-content: center; align-items: center; min-height: 100vh; padding: 20px; }

        /* Welcome Screen */
        #welcome-screen { text-align: center; background: white; padding: 30px; border-radius: 25px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); width: 100%; max-width: 400px; }
        .mode-btn { background: #fff; border: 2px solid #eee; border-radius: 15px; padding: 20px; margin: 10px 0; cursor: pointer; transition: 0.3s; display: block; width: 100%; text-decoration: none; }
        .mode-btn:hover { border-color: var(--accent); transform: translateY(-3px); }
        .mode-btn i { font-size: 30px; color: var(--accent); margin-bottom: 10px; }

        /* Main Editor */
        #main-editor { display: none; background: white; width: 100%; max-width: 450px; border-radius: 25px; padding: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); }
        .label { display: block; text-align: left; font-size: 11px; font-weight: bold; margin: 10px 0 5px; color: #777; }
        .select-box { width: 100%; padding: 10px; border-radius: 10px; border: 1px solid #ddd; margin-bottom: 10px; outline: none; }

        /* Color Palette */
        .color-palette { display: grid; grid-template-columns: repeat(6, 1fr); gap: 8px; margin-bottom: 15px; padding: 10px; background: #fdfdfd; border-radius: 10px; border: 1px solid #eee; }
        .color-dot { width: 25px; height: 25px; border-radius: 50%; cursor: pointer; border: 2px solid #ddd; justify-self: center; }
        .color-dot.active { border-color: var(--accent); transform: scale(1.1); box-shadow: 0 0 5px rgba(0,0,0,0.2); }

        /* Preview Area */
        #capture-area { width: 300px; height: 560px; margin: 10px auto; position: relative; display: flex; justify-content: center; align-items: center; }
        .phone-frame { width: 255px; height: 530px; background: #000; border: 8px solid #222; border-radius: 44px; position: relative; overflow: hidden; }
        .camera { position: absolute; background: #000; z-index: 100; left: 50%; transform: translateX(-50%); }
        .dynamic-island { top: 12px; width: 75px; height: 20px; border-radius: 20px; }
        .punch-hole { top: 14px; width: 12px; height: 12px; border-radius: 50%; }

        #preview-img, #preview-video { width: 100%; height: 100%; object-fit: cover; display: none; }
        #placeholder { color: #555; font-size: 40px; margin-top: 240px; }

        .btn { width: 100%; padding: 14px; border-radius: 50px; border: none; font-weight: bold; cursor: pointer; margin-top: 10px; display: flex; align-items: center; justify-content: center; gap: 10px; font-size: 14px; }
        .btn-upload { background: #eef6ff; color: var(--accent); border: 2px dashed var(--accent); }
        .btn-save { background: var(--accent); color: white; display: none; }
        .btn-back { background: none; color: #999; font-size: 12px; margin-top: 10px; }

        #progress-msg { font-size: 12px; color: #d9534f; margin-top: 10px; font-weight: bold; display: none; }
    </style>
</head>
<body>

    <div id="welcome-screen">
        <h2 style="margin-bottom: 10px;">DMO Mockup Studio</h2>
        <p style="color: #888; font-size: 14px; margin-bottom: 20px;">စတင်ရန် တစ်ခုရွေးချယ်ပါ</p>
        <div class="mode-btn" onclick="initTool('image')">
            <i class="fas fa-image"></i>
            <h3>Image Mockup</h3>
            <p style="font-size: 12px; color: #aaa;">ပုံများအတွက်</p>
        </div>
        <div class="mode-btn" onclick="initTool('video')">
            <i class="fas fa-video"></i>
            <h3>Video Mockup</h3>
            <p style="font-size: 12px; color: #aaa;">ဗီဒီယိုများအတွက်</p>
        </div>
    </div>

    <div id="main-editor">
        <label class="label">ဖုန်းမော်ဒယ်ရွေးပါ</label>
        <select class="select-box" id="device-select">
            <option value="iphone">iPhone (Dynamic Island)</option>
            <option value="samsung">Samsung S24/S25 Ultra</option>
            <option value="android">Vivo / Oppo / Xiaomi</option>
        </select>

        <label class="label">ဖုန်းအရောင်ရွေးပါ</label>
        <div class="color-palette" id="color-palette"></div>

        <div id="capture-area">
            <div class="phone-frame" id="phone-ui">
                <div id="cam-mod" class="camera dynamic-island"></div>
                <img id="preview-img">
                <video id="preview-video" muted playsinline loop></video>
                <i class="fas fa-plus-circle" id="placeholder"></i>
            </div>
        </div>

        <div id="progress-msg">Processing... Please wait...</div>

        <input type="file" id="file-in" style="display:none;">
        <button class="btn btn-upload" onclick="document.getElementById('file-in').click()">
            <i class="fas fa-upload"></i> ဖိုင်တင်မည်
        </button>

        <button class="btn btn-save" id="save-btn">
            Get Started <i class="fas fa-download"></i>
        </button>

        <button class="btn btn-back" onclick="location.reload()">
            <i class="fas fa-arrow-left"></i> နောက်သို့ပြန်သွားမည်
        </button>
    </div>

    <script>
        const deviceData = {
            iphone: { cam: "camera dynamic-island", radius: "44px", colors: ["#FFFFFF", "#2E2C2E", "#F5F5F0", "#4B4942", "#594F63", "#1B2431", "#E5D1D0", "#FFD700", "#FFB6C1", "#007bff"] },
            samsung: { cam: "camera punch-hole", radius: "30px", colors: ["#F9F9F9", "#252525", "#EAD8C1", "#4A4553", "#313131", "#7B92A2", "#2E3B4E", "#1A1A1A", "#D4E2D4", "#E5C1CD"] },
            android: { cam: "camera punch-hole", radius: "25px", colors: ["#FFFFFF", "#000000", "#004D40", "#7C4DFF", "#FF5252", "#FFEB3B", "#2196F3", "#4CAF50", "#FF9800", "#9C27B0"] }
        };

        let currentMode = '';

        function initTool(mode) {
            currentMode = mode;
            document.getElementById('welcome-screen').style.display = 'none';
            document.getElementById('main-editor').style.display = 'block';
            document.getElementById('file-in').accept = mode === 'image' ? "image/*" : "video/*";
            updateDeviceUI('iphone');
        }

        function updateDeviceUI(id) {
            const data = deviceData[id];
            const palette = document.getElementById('color-palette');
            palette.innerHTML = "";
            data.colors.forEach((color, i) => {
                const dot = document.createElement('div');
                dot.className = `color-dot ${i === 0 ? 'active' : ''}`;
                dot.style.backgroundColor = color;
                dot.onclick = () => {
                    document.querySelectorAll('.color-dot').forEach(d => d.classList.remove('active'));
                    dot.classList.add('active');
                    document.getElementById('phone-ui').style.borderColor = color;
                };
                palette.appendChild(dot);
            });
            document.getElementById('phone-ui').style.borderRadius = data.radius;
            document.getElementById('cam-mod').className = data.cam;
            document.getElementById('phone-ui').style.borderColor = data.colors[0];
        }

        document.getElementById('device-select').onchange = (e) => updateDeviceUI(e.target.value);

        document.getElementById('file-in').onchange = (e) => {
            const file = e.target.files[0];
            if (!file) return;
            const url = URL.createObjectURL(file);
            document.getElementById('placeholder').style.display = 'none';
            document.getElementById('save-btn').style.display = 'flex';

            if (currentMode === 'image') {
                document.getElementById('preview-img').src = url;
                document.getElementById('preview-img').style.display = 'block';
                document.getElementById('preview-video').style.display = 'none';
            } else {
                const v = document.getElementById('preview-video');
                v.src = url;
                v.style.display = 'block';
                document.getElementById('preview-img').style.display = 'none';
                v.play();
            }
        };

        document.getElementById('save-btn').onclick = async () => {
            const btn = document.getElementById('save-btn');
            const status = document.getElementById('progress-msg');
            btn.disabled = true;
            status.style.display = 'block';

            if (currentMode === 'image') {
                const canvas = await html2canvas(document.getElementById('capture-area'), { scale: 3, backgroundColor: null });
                const link = document.createElement('a');
                link.download = `Mockup_Img_${Date.now()}.png`;
                link.href = canvas.toDataURL();
                link.click();
                status.style.display = 'none';
                btn.disabled = false;
            } else {
                const video = document.getElementById('preview-video');
                const stream = video.captureStream();
                const recorder = new MediaRecorder(stream, { mimeType: 'video/webm; codecs=vp9' });
                const chunks = [];
                recorder.ondataavailable = (e) => chunks.push(e.data);
                recorder.onstop = () => {
                    const blob = new Blob(chunks, { type: 'video/webm' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `Mockup_Vid_${Date.now()}.webm`;
                    a.click();
                    status.style.display = 'none';
                    btn.disabled = false;
                };
                video.currentTime = 0;
                video.play();
                recorder.start();
                setTimeout(() => recorder.stop(), video.duration * 1000);
            }
        };
    </script>
</body>
</html>
