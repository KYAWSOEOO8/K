<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KSO Mockup STUDIO - Ultimate</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root { --primary: #1877F2; --bg: #f0f2f5; --card: #ffffff; --text: #1c1e21; --border: #ced0d4; }
        .dark-mode { --bg: #18191a; --card: #242526; --text: #e4e6eb; --border: #3e4042; }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; transition: 0.3s; }
        body { background: var(--bg); color: var(--text); display: flex; justify-content: center; align-items: center; min-height: 100vh; padding: 20px; }

        .app-card { background: var(--card); width: 100%; max-width: 450px; border-radius: 25px; padding: 25px; box-shadow: 0 15px 50px rgba(0,0,0,0.2); border: 1px solid var(--border); }
        
        /* Header Style */
        .fb-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .fb-logo-section { display: flex; align-items: center; gap: 10px; color: var(--primary); }
        .fb-logo-section i { font-size: 35px; }
        .kso-text { font-size: 24px; font-weight: 800; color: var(--text); letter-spacing: 1px; }
        
        .theme-toggle { cursor: pointer; width: 40px; height: 40px; border-radius: 50%; background: var(--bg); display: flex; align-items: center; justify-content: center; border: 1px solid var(--border); color: var(--text); }

        .tabs { display: flex; background: var(--bg); border-radius: 12px; padding: 5px; margin-bottom: 15px; border: 1px solid var(--border); }
        .tab-btn { flex: 1; padding: 12px; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; color: #65676b; background: none; display: flex; align-items: center; justify-content: center; gap: 8px; }
        .tab-btn.active { background: var(--card); color: var(--primary); box-shadow: 0 2px 8px rgba(0,0,0,0.1); }

        .settings-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 20px; }
        .label { font-size: 10px; font-weight: bold; color: #888; text-transform: uppercase; margin-bottom: 5px; display: flex; align-items: center; gap: 5px; }
        .select-ui { width: 100%; padding: 10px; border-radius: 10px; border: 1px solid var(--border); background: var(--card); color: var(--text); cursor: pointer; font-size: 13px; }

        /* Capture Area */
        #capture-area { background: transparent; padding: 20px; display: flex; justify-content: center; align-items: center; }
        
        .phone { 
            width: 250px; height: 500px; background: #000; 
            border: 11px solid #222; border-radius: 46px; 
            position: relative; overflow: hidden; display: flex; align-items: center; justify-content: center;
            box-shadow: 0 20px 50px rgba(0,0,0,0.4);
        }

        .notch { position: absolute; top: 0; left: 50%; transform: translateX(-50%); background: #000; z-index: 100; }
        .island { width: 85px; height: 26px; border-radius: 20px; margin-top: 14px; }
        .punch { width: 14px; height: 14px; border-radius: 50%; margin-top: 18px; border: 1px solid #222; }
        .drop { width: 40px; height: 18px; border-radius: 0 0 15px 15px; }

        .screen { width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; background: #000; position: relative; }
        #img-view, #vid-view { width: 100%; height: 100%; object-fit: cover; display: none; }
        
        .ratio-1-1 { height: 250px !important; }
        .ratio-16-9 { height: 140px !important; }

        .btn { width: 100%; padding: 16px; border: none; border-radius: 15px; font-weight: bold; cursor: pointer; margin-top: 10px; display: flex; align-items: center; justify-content: center; gap: 10px; font-size: 15px; }
        .btn-upload { background: #E7F3FF; color: var(--primary); }
        .btn-save { background: var(--primary); color: white; display: none; box-shadow: 0 4px 15px rgba(24, 119, 242, 0.3); }
        
        #loading { display: none; font-size: 13px; font-weight: bold; color: var(--primary); margin-top: 10px; text-align: center; }
    </style>
</head>
<body>

<div class="app-card">
    <div class="fb-header">
        <div class="fb-logo-section">
            <i class="fab fa-facebook"></i>
            <span class="kso-text">KSO</span>
        </div>
        <div class="theme-toggle" onclick="document.body.classList.toggle('dark-mode')">
            <i class="fas fa-circle-half-stroke"></i>
        </div>
    </div>

    <div class="tabs">
        <button class="tab-btn active" onclick="setMode('image', this)"><i class="fas fa-image"></i> Photo</button>
        <button class="tab-btn" onclick="setMode('video', this)"><i class="fas fa-video"></i> Video</button>
    </div>

    <div class="settings-grid">
        <div>
            <label class="label"><i class="fas fa-mobile"></i> Device Notch</label>
            <select class="select-ui" onchange="setNotch(this.value)">
                <option value="island">Dynamic Island</option>
                <option value="punch">Punch Hole</option>
                <option value="drop">Waterdrop</option>
                <option value="none">No Notch</option>
            </select>
        </div>
        <div>
            <label class="label"><i class="fas fa-palette"></i> Frame Color</label>
            <select class="select-ui" onchange="document.getElementById('ph-box').style.borderColor = this.value">
                <option value="#222">Matte Black</option>
                <option value="#ced0d4">Silver</option>
                <option value="#d4af37">Champagne Gold</option>
                <option value="#5b5167">Deep Purple</option>
            </select>
        </div>
        <div id="ratio-box" style="display:none; grid-column: span 2;">
            <label class="label"><i class="fas fa-up-right-and-down-left-from-center"></i> Video Ratio</label>
            <select class="select-ui" onchange="updateRatio(this.value)">
                <option value="full">Full Screen (9:16)</option>
                <option value="ratio-1-1">Square (1:1)</option>
                <option value="ratio-16-9">Landscape (16:9)</option>
            </select>
        </div>
    </div>

    <div id="capture-area">
        <div class="phone" id="ph-box">
            <div id="notch-ui" class="notch island"></div>
            <div class="screen">
                <i class="fas fa-plus-circle" id="hint" style="color:#222; font-size:45px;"></i>
                <img id="img-view" crossorigin="anonymous">
                <video id="vid-view" muted loop playsinline crossorigin="anonymous"></video>
            </div>
        </div>
    </div>

    <div id="loading"><i class="fas fa-spinner fa-spin"></i> Generating HD Mockup...</div>

    <input type="file" id="media-input" style="display:none;" onchange="loadMedia(this)">
    
    <button class="btn btn-upload" onclick="document.getElementById('media-input').click()">
        <i class="fas fa-file-export"></i> <span id="btn-text">Add Photo</span>
    </button>
    
    <button class="btn btn-save" id="save-btn" onclick="downloadPNG()">
        <i class="fas fa-download"></i> Save Transparent PNG
    </button>
</div>

<script>
    let currentMode = 'image';

    function setMode(type, el) {
        currentMode = type;
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        el.classList.add('active');
        document.getElementById('btn-text').innerText = type === 'image' ? "Add Photo" : "Add Video";
        document.getElementById('media-input').accept = type === 'image' ? "image/*" : "video/*";
        document.getElementById('ratio-box').style.display = type === 'video' ? 'block' : 'none';
        resetUI();
    }

    function resetUI() {
        document.getElementById('img-view').style.display = 'none';
        document.getElementById('vid-view').style.display = 'none';
        document.getElementById('vid-view').pause();
        document.getElementById('hint').style.display = 'block';
        document.getElementById('save-btn').style.display = 'none';
    }

    function setNotch(n) {
        const ui = document.getElementById('notch-ui');
        ui.className = 'notch ' + n;
        ui.style.display = n === 'none' ? 'none' : 'block';
    }

    function updateRatio(r) {
        const v = document.getElementById('vid-view');
        v.className = (r === 'full') ? '' : r;
    }

    function loadMedia(input) {
        const file = input.files[0]; if(!file) return;
        const url = URL.createObjectURL(file);
        document.getElementById('hint').style.display = 'none';
        document.getElementById('save-btn').style.display = 'flex';

        if(currentMode === 'image') {
            const img = document.getElementById('img-view');
            img.src = url; img.style.display = 'block';
        } else {
            const vid = document.getElementById('vid-view');
            vid.src = url; vid.style.display = 'block';
            vid.play();
        }
    }

    async function downloadPNG() {
        document.getElementById('loading').style.display = 'block';
        const area = document.getElementById('capture-area');
        
        try {
            const canvas = await html2canvas(area, {
                backgroundColor: null,
                scale: 3,
                useCORS: true,
                allowTaint: true
            });
            const link = document.createElement('a');
            link.download = `KSO_Mockup_${Date.now()}.png`;
            link.href = canvas.toDataURL("image/png");
            link.click();
        } catch (err) {
            alert("Export Error: " + err);
        }
        document.getElementById('loading').style.display = 'none';
    }
</script>
</body>
</html>
